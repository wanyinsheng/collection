## 为什么 TCP 连接需要三次握手，两次不可以么，为什么？
### TCP三次握手的必要性

#### 1. 确认双方的接收与发送能力
##### 1.1 两次握手不足
如果只有两次握手，即客户端发送一个同步请求（SYN）到服务器，服务器回复一个确认（ACK），这样只能确认服务器接收和发送的能力，但不能确认客户端的接收能力。

##### 1.2 三次握手的过程
1. 客户端发送一个同步请求（SYN）到服务器，表明客户端希望建立连接。
2. 服务器回复一个同步-确认消息（SYN-ACK），确认收到客户端的请求，并且告诉客户端它的接收和发送能力是正常的。
3. 客户端再次发送确认消息（ACK）给服务器，确认它已经收到服务器的同步-确认消息，这样客户端的接收能力也得到了验证。

#### 2. 防止失效的连接请求建立连接
##### 2.1 旧的连接请求
网络中可能存在延迟长时间才到达服务器的旧的连接请求。如果只有两次握手，那么服务器收到这样一个请求后，会误以为是新的连接请求，就会建立连接，并等待客户端发送数据，造成资源浪费。

##### 2.2 三次握手解决方案
三次握手通过最后一次客户端发送的确认（ACK），可以忽略掉旧的连接请求。只有当客户端再次确认后，服务器才会认为连接是当前有效的，并开始数据传输。如果是一个旧的同步请求，客户端不会对服务器的同步-确认消息（SYN-ACK）进行响应，因此服务器不会建立连接。

#### 3. 同步序列号
##### 3.1 序列号的重要性
TCP连接中的序列号用于保证数据包的顺序和完整性。在三次握手过程中，双方都会通告自己的初始序列号，确保数据传输的一致性和可靠性。

##### 3.2 两次握手的问题
如果只进行两次握手，那么只有服务器的序列号被确认，客户端的序列号没有得到服务器的确认，这可能导致数据传输中的问题。

#### 4. 结论
三次握手是确保TCP连接的可靠性的最小握手次数。它可以验证双方的接收和发送能力，防止失效的连接请求造成资源浪费，并且同步双方的序列号以保证数据传输的一致性和可靠性。两次握手无法满足这些需求，因此不足以建立一个稳定可靠的TCP连接。
